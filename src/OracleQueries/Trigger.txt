CREATE OR REPLACE TRIGGER EQUIPMENT_CON_AUDIT
AFTER INSERT OR UPDATE OR DELETE ON "CONT"."EQUIPMENT_CONTRACT" 
DECLARE
    v_timestamp NUMBER(38,0);
    v_rivisonID NUMBER(38,0);
BEGIN
    SELECT REVISION_SEQ.NEXTVAL,GETTIMESTAMP INTO v_rivisonID, v_timestamp FROM DUAL;
    IF INSERTING THEN 
        INSERT INTO REVISION (ID,TIMESTAMP,MODIFIED_BY) VALUES (v_rivisonID, v_timestamp, 'SYSTEM_USER');
        INSERT INTO EQUIPMENT_CONTRACT_AUDITING (REVISION_ID,REVISION_TYPE,EQUIPMENT_CONTRACT_ID,EQUIPMENT_ID,
        CONTRACT_ID,IN_CONTRACT_START_DATE,IN_CONTRACT_STOP_DATE,TRANSFER_PREVIOUS_EARNINGS,IS_DELETED)
        SELECT v_rivisonID, '0',ec.EQUIPMENT_CONTRACT_ID, ec.EQUIPMENT_ID, ec.CONTRACT_ID, ec.IN_CONTRACT_START_DATE,
            ec.IN_CONTRACT_STOP_DATE, ec.TRANSFER_PREVIOUS_EARNINGS, ec.IS_DELETED 
            FROM EQUIPMENT_CONTRACT ec WHERE ROWNUM = 1 ORDER BY ec.EQUIPMENT_CONTRACT_ID DESC;       
    
    END IF;
END;

CREATE OR REPLACE FUNCTION getTimestamp RETURN NUMBER AS
LANGUAGE JAVA NAME 'SystemTimestamp.getTimestamp() return long';

select GETTIMESTAMP from dual;

INSERT INTO RECEIVABLES_CYCLES (CYCLE_ID,EDI_GS_GE_ID, PAYOR, PAYEE, RECORD_TYPE, ACCOUNT_TYPE_CD, TRANSACTION_QUALIFIER_CD, ALLOWED_MONTH, EARNED_MONTH, 
        ACCOUNT_DESCRIPTION_CD, STATE_TAX_CD, EQUIPMENT_INITIAL, EQUIPMENT_NUMBER, AAR_EQUIPMENT_TYPE, REFERENCE_NUM_QUALIFER_ONE, REFERENCE_NUMBER_ONE,
        REFERENCE_DESCRIPTION_ONE, REFERENCE_NUM_QUALIFER_TWO, REFERENCE_NUMBER_TWO, REFERENCE_DESCRIPTION_TWO, TARIFF_REFERENCE_USE_CD, TARIFF_AGENCY_CD, TARIFF_NUMBER,
        TARIFF_NUM_SUFFIX, TARIFF_SUPPLEMENT, TARIFF_SECTION, TARIFF_ITEM_NUMBER, TARIFF_REF_NUM_QUALIFIER, TARIFF_REFERENCE_NUMBER, TARIFF_SCAC, TARIFF_DOCKET_CONTROL_NUM,
        TARIFF_DOCKET_IDENTIFIER, TARIFF_REVISION_NUMBER, TARIFF_GROUP_TITLE, RATE_SOURCE, TIME_RATE, MILE_RATE, APPURTENANCE_RATE, OTHER_RATE, INVALID_RATE, BEG_DATE,
        BEG_HOUR, BEG_DATE_AND_TIME, BEG_SPLC, BEG_ROAD, END_DATE, END_HOUR, END_DATE_AND_TIME, END_SPLC, END_ROAD, AAR_POOL_CD, CONTRACT_REF_NUM_QUALIFER,
        CONTRACT_REG_AGENCY_CD, CONTRACT_SCAC, ISSUING_CARRIER_IDENTIFIER, CONTRACT_NUMBER, CONTRACT_SUFFIX, CONTRACT_EFFECTIVE_DATE, CONTRACT_EXPIRATION_DATE,
        CYCLE_STATUS_CD, PAY_CODE, CAR_TYPE_GROUP_CD, TIME_INDICATOR, TIME_UNITS, MILEAGE_SETTLEMENT_CD, LOADED_MILES, EMPTY_MILES, TOTAL_AMOUNT, TIME_AMOUNT, MILE_AMOUNT,
        APPURTENANCE_AMOUNT, PENALTY_AMOUNT, PENALTY_CD, CREATED_ON, CREATED_BY, LAST_UPDATED_ON, LAST_UPDATED_BY, CYCLE_TYPE_ID, NOTES, BEGIN_LOCATION, END_LOCATION,
        RECEIVABLE_CYCLE_STATUS, DATA_SOURCE, PROCESSING_ERROR_STATUS, WARNING_STATUS, PROCESSING_FLAG, IS_DELETED) 
        SELECT RECEIVABLES_CYCLES_ID_SEQ.NEXTVAL,EDI_GS_GE_ID, PAYOR, PAYEE, RECORD_TYPE, ACCOUNT_TYPE_CD, TRANSACTION_QUALIFIER_CD, ALLOWED_MONTH, EARNED_MONTH, 
        ACCOUNT_DESCRIPTION_CD, STATE_TAX_CD, EQUIPMENT_INITIAL, EQUIPMENT_NUMBER, AAR_EQUIPMENT_TYPE, REFERENCE_NUM_QUALIFER_ONE, REFERENCE_NUMBER_ONE,
        REFERENCE_DESCRIPTION_ONE, REFERENCE_NUM_QUALIFER_TWO, REFERENCE_NUMBER_TWO, REFERENCE_DESCRIPTION_TWO, TARIFF_REFERENCE_USE_CD, TARIFF_AGENCY_CD, TARIFF_NUMBER,
        TARIFF_NUM_SUFFIX, TARIFF_SUPPLEMENT, TARIFF_SECTION, TARIFF_ITEM_NUMBER, TARIFF_REF_NUM_QUALIFIER, TARIFF_REFERENCE_NUMBER, TARIFF_SCAC, TARIFF_DOCKET_CONTROL_NUM,
        TARIFF_DOCKET_IDENTIFIER, TARIFF_REVISION_NUMBER, TARIFF_GROUP_TITLE, RATE_SOURCE, TIME_RATE, MILE_RATE, APPURTENANCE_RATE, OTHER_RATE, INVALID_RATE, BEG_DATE,
        BEG_HOUR, BEG_DATE_AND_TIME, BEG_SPLC, BEG_ROAD, END_DATE, END_HOUR, END_DATE_AND_TIME, END_SPLC, END_ROAD, AAR_POOL_CD, CONTRACT_REF_NUM_QUALIFER,
        CONTRACT_REG_AGENCY_CD, CONTRACT_SCAC, ISSUING_CARRIER_IDENTIFIER, CONTRACT_NUMBER, CONTRACT_SUFFIX, CONTRACT_EFFECTIVE_DATE, CONTRACT_EXPIRATION_DATE,
        CYCLE_STATUS_CD, PAY_CODE, CAR_TYPE_GROUP_CD, TIME_INDICATOR, TIME_UNITS, MILEAGE_SETTLEMENT_CD, LOADED_MILES, EMPTY_MILES, TOTAL_AMOUNT, TIME_AMOUNT, MILE_AMOUNT,
        APPURTENANCE_AMOUNT, PENALTY_AMOUNT, PENALTY_CD, CREATED_ON, CREATED_BY, LAST_UPDATED_ON, LAST_UPDATED_BY, CYCLE_TYPE_ID, NOTES, BEGIN_LOCATION, END_LOCATION,
        RECEIVABLE_CYCLE_STATUS, DATA_SOURCE, PROCESSING_ERROR_STATUS, WARNING_STATUS, PROCESSING_FLAG, IS_DELETED
        FROM RECEIVABLES_CYCLES WHERE  CYCLE_ID = '931859';    

***********************************************************************************************************************************************************************

CREATE OR REPLACE TRIGGER CREATE_RECEIVABLES_AUDIT
AFTER INSERT OR UPDATE OR DELETE ON "CARHIRE"."RECEIVABLES_CYCLES" 
DECLARE
    v_timestamp NUMBER(38,0);
    v_rivisonID NUMBER(38,0);
BEGIN
    SELECT REVISION_SEQ.NEXTVAL,GETTIMESTAMP INTO v_rivisonID, v_timestamp FROM DUAL;
    IF INSERTING THEN 
        INSERT INTO REVISION (ID,TIMESTAMP,MODIFIED_BY) VALUES (v_rivisonID, v_timestamp, 'SYSTEM_USER');
        INSERT INTO RECEIVABLES_CYCLES_AUDITING (CYCLE_ID,REVISION_ID,REVISION_TYPE,EDI_GS_GE_ID, PAYOR, PAYEE, RECORD_TYPE, ACCOUNT_TYPE_CD, TRANSACTION_QUALIFIER_CD, ALLOWED_MONTH, EARNED_MONTH, 
        ACCOUNT_DESCRIPTION_CD, STATE_TAX_CD, EQUIPMENT_INITIAL, EQUIPMENT_NUMBER, AAR_EQUIPMENT_TYPE, REFERENCE_NUM_QUALIFER_ONE, REFERENCE_NUMBER_ONE,
        REFERENCE_DESCRIPTION_ONE, REFERENCE_NUM_QUALIFER_TWO, REFERENCE_NUMBER_TWO, REFERENCE_DESCRIPTION_TWO, TARIFF_REFERENCE_USE_CD, TARIFF_AGENCY_CD, TARIFF_NUMBER,
        TARIFF_NUM_SUFFIX, TARIFF_SUPPLEMENT, TARIFF_SECTION, TARIFF_ITEM_NUMBER, TARIFF_REF_NUM_QUALIFIER, TARIFF_REFERENCE_NUMBER, TARIFF_SCAC, TARIFF_DOCKET_CONTROL_NUM,
        TARIFF_DOCKET_IDENTIFIER, TARIFF_REVISION_NUMBER, TARIFF_GROUP_TITLE, RATE_SOURCE, TIME_RATE, MILE_RATE, APPURTENANCE_RATE, OTHER_RATE, INVALID_RATE, BEG_DATE,
        BEG_HOUR, BEG_DATE_AND_TIME, BEG_SPLC, BEG_ROAD, END_DATE, END_HOUR, END_DATE_AND_TIME, END_SPLC, END_ROAD, AAR_POOL_CD, CONTRACT_REF_NUM_QUALIFER,
        CONTRACT_REG_AGENCY_CD, CONTRACT_SCAC, ISSUING_CARRIER_IDENTIFIER, CONTRACT_NUMBER, CONTRACT_SUFFIX, CONTRACT_EFFECTIVE_DATE, CONTRACT_EXPIRATION_DATE,
        CYCLE_STATUS_CD, PAY_CODE, CAR_TYPE_GROUP_CD, TIME_INDICATOR, TIME_UNITS, MILEAGE_SETTLEMENT_CD, LOADED_MILES, EMPTY_MILES, TOTAL_AMOUNT, TIME_AMOUNT, MILE_AMOUNT,
        APPURTENANCE_AMOUNT, PENALTY_AMOUNT, PENALTY_CD, CREATED_ON, CREATED_BY, LAST_UPDATED_ON, LAST_UPDATED_BY, CYCLE_TYPE_ID, NOTES, BEGIN_LOCATION, END_LOCATION,
        RECEIVABLE_CYCLE_STATUS, DATA_SOURCE, PROCESSING_ERROR_STATUS, WARNING_STATUS, PROCESSING_FLAG, IS_DELETED) 
        SELECT CYCLE_ID,v_rivisonID,'0',EDI_GS_GE_ID, PAYOR, PAYEE, RECORD_TYPE, ACCOUNT_TYPE_CD, TRANSACTION_QUALIFIER_CD, ALLOWED_MONTH, EARNED_MONTH, 
        ACCOUNT_DESCRIPTION_CD, STATE_TAX_CD, EQUIPMENT_INITIAL, EQUIPMENT_NUMBER, AAR_EQUIPMENT_TYPE, REFERENCE_NUM_QUALIFER_ONE, REFERENCE_NUMBER_ONE,
        REFERENCE_DESCRIPTION_ONE, REFERENCE_NUM_QUALIFER_TWO, REFERENCE_NUMBER_TWO, REFERENCE_DESCRIPTION_TWO, TARIFF_REFERENCE_USE_CD, TARIFF_AGENCY_CD, TARIFF_NUMBER,
        TARIFF_NUM_SUFFIX, TARIFF_SUPPLEMENT, TARIFF_SECTION, TARIFF_ITEM_NUMBER, TARIFF_REF_NUM_QUALIFIER, TARIFF_REFERENCE_NUMBER, TARIFF_SCAC, TARIFF_DOCKET_CONTROL_NUM,
        TARIFF_DOCKET_IDENTIFIER, TARIFF_REVISION_NUMBER, TARIFF_GROUP_TITLE, RATE_SOURCE, TIME_RATE, MILE_RATE, APPURTENANCE_RATE, OTHER_RATE, INVALID_RATE, BEG_DATE,
        BEG_HOUR, BEG_DATE_AND_TIME, BEG_SPLC, BEG_ROAD, END_DATE, END_HOUR, END_DATE_AND_TIME, END_SPLC, END_ROAD, AAR_POOL_CD, CONTRACT_REF_NUM_QUALIFER,
        CONTRACT_REG_AGENCY_CD, CONTRACT_SCAC, ISSUING_CARRIER_IDENTIFIER, CONTRACT_NUMBER, CONTRACT_SUFFIX, CONTRACT_EFFECTIVE_DATE, CONTRACT_EXPIRATION_DATE,
        CYCLE_STATUS_CD, PAY_CODE, CAR_TYPE_GROUP_CD, TIME_INDICATOR, TIME_UNITS, MILEAGE_SETTLEMENT_CD, LOADED_MILES, EMPTY_MILES, TOTAL_AMOUNT, TIME_AMOUNT, MILE_AMOUNT,
        APPURTENANCE_AMOUNT, PENALTY_AMOUNT, PENALTY_CD, CREATED_ON, CREATED_BY, LAST_UPDATED_ON, LAST_UPDATED_BY, CYCLE_TYPE_ID, NOTES, BEGIN_LOCATION, END_LOCATION,
        RECEIVABLE_CYCLE_STATUS, DATA_SOURCE, PROCESSING_ERROR_STATUS, WARNING_STATUS, PROCESSING_FLAG, IS_DELETED
        FROM RECEIVABLES_CYCLES WHERE ROWNUM = 1 ORDER BY CYCLE_ID DESC;       
    
    END IF;
END;